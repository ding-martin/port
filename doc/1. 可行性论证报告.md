## 产品介绍
本项目是针对保证公司软件的可靠性、减少人工重复性劳动和及早发现软件修改时的问题为目的，而开展的项目。本项目预计会是一套包含从开发初期的代码自动化测试到开发完成后的用户界面流程自动化测试的综合系统。在完成本测试系统后，预计可以减少至少50%的重复测试操作。

## 需求分析
### 必须实现的需求
1. 静态代码审查
1. 持续集成
1. 单元测试方法培训资料
1. UI识别驱动
1. 自动化测试用例管理
1. 关键字驱动的UI自动化测试

### 建议但非必要需求
1. 实施单元测试
1. 测试策略引擎
1. 随机操作压力测试
1. 全部代码人工评审

### 可达性评估
|原始需求|可达性|实现方案|当前状态|
|---|:---:|---|:---:|
|静态代码审查|可实现|使用SonarCube和Reshaper做静态审查，仍需和代码库进行关联|一定基础|
|持续集成|可实现|可以使用Jenkins或者TeamCity进行持续集成，仍需和代码库进行<br>关联和编制脚本，此项配合静态代码审查和单元测试使用|未实现|
|单元测试方法培训资料|可实现|已编写完成主体部分，可以给开发人员学习和反馈|一定基础|
|UI识别驱动|可实现|可以使用Ranorex为基础编写UI识别，需要做一些封装以便于使用|未实现|
|自动化测试用例管理|可实现|自行编制或找支持外部调用的测试用例管理工具|未实现|
|关键字驱动的UI自动化测试|有难度|将用例通过软件转化为操作序列，使用封装的Ranorex识别UI上的内容<br>并进行操作、判断和显示结果|未实现|
|实施单元测试|有前提|需要开发人员学习单元测试方法，并在部分项目上实验性实施|未实现|
|全部代码人工评审|有前提|每天需要安排1小时进行代码评审，通过git中的合并请求和各自的功能分支来实现|未实现|
|测试策略引擎|比较困难|通过界面关键字和测试需求，根据测试策略生成测试用例，需要一定的语义识别和<br>流程图识别的开发工作|未实现|
|随机操作压力测试|有困难|需要在切换页面后获取页面所有元素及其属性，根据可执行的操作进行执行操作，<br>比前面的测试多了自动生成关键字的部分|未实现|

### 需求关联性分析
![自动化测试系统需求关系图](./img/自动化测试系统需求关系图.png)

## 产品规格
### 研发成果
1. 在编写代码时，可以实时进行代码静态检查。
1. 在代码推入数据库后，对代码自动构建，可以自动对代码间的配合进行静态检查。 同时执行代码中的单元测试，确认各个模块之间是否有互相影响。
1. 在编写了测试用例后就可以根据用例自动执行测试工作，因此部分测试工作可以交给机器执行。
1. 可以在软件回归测试时，减少至少50%的重复工作，并且在软件BUG修正后可以自动对修改内容的正确性进行检查，加快了反馈的速度。 

### 产品功能汇总
参考: [必须实现的需求](#必须实现的需求) 和 [建议但非必要需求](#建议但非必要需求)
## 技术可行性分析
### 整体方案概述
系统架构图如下所示:
![系统架构](./img/系统架构.png)
#### 各个模块介绍
1. 界面呈现，包括三个部分
    * CodeReview:人工代码审查
    * 用例设计和编排页面:编制自动化测试用例
    * 测试报告页面:各个项目的各个分支最新的自动化测试结果、代码静态审查结果。
1. 开发工作
    * 在开发时根据规范进行开发，可以保证代码的初步质量。
    * 在开发过程中使用Resharper导入CodeStyle配置，来实时反馈代码有问题的地方，促进修改。
1. 代码库
    * 将开发的代码进行管理的库
    * 在将代码推送到库中时，就可以在代码审查工具上进行代码审查
    * 代码审查没有问题后，就可以推送到master库中，作为发布之用。
1. 持续集成服务
    * 在代码推入开发库中后，持续集成服务通过**持续集成脚本**自动执行。
    * 首先通过MsBuild对代码进行构建，通过SonarQube执行代码静态检查和单元测试，给出测试结果。
    * 然后通过**部署脚本**将程序部署到测试机上，并运行起来。
    * 按照自动化测试用例通过**自动化测试核心服务**驱动执行自动化测试工作，包括UI自动化测试和(通信)接口自动化测试。
1. 自动化测试核心服务
   1. UI驱动:将界面的各类操作变为可以用代码控制的驱动
    1. 界面元素获取:取得当前测试软件界面各个元素的执行方法，并生成**基本操作**代码。
    1. 各项基本操作在用例设计中的映射驱动:将自然的语言和软件基本操作代码进行映射。
    1. 单个用例:每个用例必须包含的基本操作项。
    1. 生成流程代码:根据所有编排的用例，生成总体执行流程。
    1. 生成执行代码:通过映射驱动和流程代码，映射出可执行的操作代码。
    1. 最终通过UI驱动执行各项操作，并记录结果。
### 技术路线
1. 本系统主要目的
    * 在测试过程中减少重复性的手工测试工作，在进行人工测试时，难免出现错、漏问题，使用机器执行则可以完全避免这方面的问题。
    * 并且在回归测试时，可以更高效的反馈修改是否合格，缩短了开发和测试之间的响应时间。
1. 技术发展路线
    1. 完成初步的单计算机纯软件自动化测试:该系统只能完成只涉及软件的部分进行自动化测试，并对部分可以使用软件模拟的接口进行测试。
    1. 全部接口的模拟测试:对于所有外部接口进行模拟，实现和设备分离的状态下模拟设备执行测试。在该阶段，可以完成大部分功能的测试工作，此时需要自行设计一款控制卡进行外部接口的仿真工作。在该阶段可以考虑将软件升级，所有工作都使用TCP/IP协议和控制卡通信，由控制卡负责所有的外部设备通信工作，并且由此来实现所有销售设备状态统一网络管理的功能。
    1. 结合设备的自动化测试系统。
### 关键技术与难点分析

### 进度比较分析

### 预算比较分析

### 风险比较分析